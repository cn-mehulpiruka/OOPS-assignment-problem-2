1.Create two tables for Impressions and Clicks. Ensure that the tables have        columns named appropriately and suitable data types.


2. Explore the data and create queries to identify and add primary key columns if any.
(Hint : Make use of COUNT function)
        I found that there is no column with unique values in the clicks table but there is column named ‘key_part’ in the impressions table.But it seems no use to create key_part as my primary key.

3. Determine whether you can create a Foreign Key constraint in the tables. Justify the reasons behind the same.
         Since there is no primary key ,foreign key is not created

4.Date Function - Day of the week and corresponding volume of Clicks.

      select extract(dow from dt ) ,count(*) from click group by extract(dow from dt);
Extracts the day of the week and the count of the repetitions and groups by the day of the week in the table named ‘click’.

5. Date Function - Day of the week and corresponding volume of Impressions.

    select extract(dow from dt ) ,count(*) from impression group by extract(dow from dt);
Extracts the day of the week and the count of the repetitions and groups by the day of the week in the table named ‘impression’’

6.Region wise count of Impressions order by count of Impressions

select distinct count(region),region from impression group by (region) order by (region);
	Gives the count of the impressions for every region in the table ‘impression’.

7.Region wise count of clicks order by Region.

select distinct count(region),region from click1 group by (region) order by (region);
	Gives the count of the impressions for every region in the table ‘click’.
8.Region wise clicks and Impressions.
(Only regions present in both the tables to be listed) 

select distinct impression.region
from impression
inner join click
on impression.region_id=click.region_id
order by impression.region;
 
We will get the common distinct regions present in both the ‘impression’ and ‘click’ tables.


9.Region wise clicks and Impressions.
(Regions present in either tables to be listed)

select distinct impression.region,click.region
from impression
full outer join click
on impression.region_id=click.region_id;
	We will get the regions present in either of  the ‘impression’ and  ‘click’ tables.

10.Query with Region, Indicator (Impressions or Clicks) and Count of Impressions or Clicks.

select region,count(region_id)as impression from impression group by region union all select region,count(region_id)as click from click group by region;

 	We will get the region and the count of impressions and clicks,including the indicators (whether impressions or clicks)

11.Region wise count of clicks. The region should not be present in the  Impressions table
(Make use of left join to implement this)


select click.region,count(*)
from click left join impression 
on impression.region_id=click.region_id
where click.region is null
group by click.region

	We will get the region wise clicks in click table  which are not present in the impression table. 

12.Region wise count of impressions. The region should not be present in the  Clicks table
(Make use of right join to implement this)

select click.region,count(*)
from click right =join impression 
on impression.region_id=click.region_id
where click.region is null
group by click.region
	
	We will get the region wise impressions in impression table  which are not present in the click table. 

13.Region wise count of clicks. The region should not be present in the  Impressions table
(Make use of “IN” clause to implement this)

select count(*) ,region from click where region not in (Select distinct region from impression) group by region;
	
	With the use of ‘In’ clause here we will get the region wise clicks in click table  which are not present in the impression table. 

14.Region wise count of impressions. The region should not be present in the  Clicks table
(Make use of “IN” clause to implement this)

select count(*) ,region from impression where region not in (Select distinct region from click)
group by impression.region;

	With the use of ‘In’ clause here we will get the region wise clicks in click table  which are not present in the impression table. 
15. Find the average number of Clicks and Impressions per region.

select (tbl.cnt + tbl1.cnt/2),tbl.region as impression,tbl1.region as click
from(select count(*)as cnt,region from impression group by region)as tbl,
(select count(*)as cnt,region from click group by region) as tbl1 where tbl.region=tbl1.region

Here we will get the average number of clicks from ‘click’ table  and impressions  from ‘impression’ table

16. List top 5 Cities in US which are generating most number of Identifiable clicks (i.e. click which can be tied back to impressions)

select click.city from click, impression where impression.impressionid=click.impressionid limit 5;
	Here we will get the top 5 cities in U.S which have more clicks and it is done by keeping the limit as 5


17. Describe user’s browsing pattern by Region (i.e. For each Region which hour of the day has most impressions.)

select tbl.cnt,tbl1.cnt,tbl.region as click,tbl1.region as impression
from 
(select extract(hour from time ) ,region,count(*) as cnt
from click
group by extract(hour from time),region
 order by extract(hour from time))as tbl ,
(select extract(hour from time),region,
count(*)as cnt from impression
group by extract(hour from time),region
 order by extract(hour from time))as tbl1
 where tbl.region=tbl1.region;
	Here we will get the hour of the day which have the most impressions for every region and this is done by using sub queries.



























